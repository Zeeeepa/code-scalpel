# [20260117_REFACTOR] Updated ports to avoid conflicts with common Docker services
# Configurable via environment variables:
#   JENKINS_HTTP_PORT (default: 8088)
#   JENKINS_AGENT_PORT (default: 50001)
version: '3.8'

services:
  jenkins:
    image: jenkins/jenkins:lts
    privileged: true
    user: root
    ports:
      # HTTP port: 8088 (avoids conflict with common services on 8080)
      - "${JENKINS_HTTP_PORT:-8088}:8080"
      # Agent port: 50001 (avoids conflict with default Jenkins on 50000)
      - "${JENKINS_AGENT_PORT:-50001}:50000"
    volumes:
      - jenkins_home:/var/jenkins_home
      # Mount the project root so Jenkins can access files without git clone if desired
      # Or you can rely on Git plugin
      - ../:/var/code-scalpel-source
    container_name: local-jenkins
    environment:
      - JAVA_OPTS=-Djenkins.install.runSetupWizard=false

volumes:
  jenkins_home:
