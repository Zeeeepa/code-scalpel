Hash-based duplicate function/class analysis (SHA-256 over stripped code)
Command:
python - <<'PY'
import ast, hashlib
from pathlib import Path

root = Path('src/code_scalpel').resolve()
entries = {}

def normalize(code: str) -> str:
    lines = []
    for line in code.splitlines():
        stripped = line.strip()
        if not stripped or stripped.startswith('#'):
            continue
        lines.append(stripped)
    return '\n'.join(lines)

for path in root.rglob('*.py'):
    try:
        src = path.read_text(encoding='utf-8')
    except Exception:
        continue
    try:
        tree = ast.parse(src)
    except SyntaxError:
        continue
    for node in ast.walk(tree):
        if isinstance(node, (ast.FunctionDef, ast.AsyncFunctionDef, ast.ClassDef)):
            segment = ast.get_source_segment(src, node)
            if not segment:
                continue
            norm = normalize(segment)
            if not norm:
                continue
            h = hashlib.sha256(norm.encode()).hexdigest()
            entries.setdefault(h, []).append((path, getattr(node, 'name', '<anon>'), node.lineno))

duplicates = {h: items for h, items in entries.items() if len(items) > 1}
print(f"Total definitions hashed: {len(entries)}")
print(f"Duplicate groups: {len(duplicates)}")

items = sorted(duplicates.items(), key=lambda kv: len(kv[1]), reverse=True)[:10]
for h, defs in items:
    print(f"\nGroup size {len(defs)} hash {h[:10]}...")
    for path, name, lineno in defs[:5]:
        rel = path.relative_to(root.parent)
        print(f"  {rel}:{lineno} {name}")
    if len(defs) > 5:
        print(f"  ... {len(defs)-5} more")
PY

Summary:
Total definitions hashed: 5686
Duplicate groups: 223

Top groups (truncated to first 5 entries each):
- Group size 4 hash 4e7afc0079... (parser __init__ duplicates)
  code_scalpel/code_parsers/csharp_parsers/csharp_parsers_ReSharper.py:25 __init__
  code_scalpel/code_parsers/csharp_parsers/csharp_parsers_Roslyn-Analyzers.py:25 __init__
  code_scalpel/code_parsers/csharp_parsers/csharp_parsers_SonarQube.py:25 __init__
  code_scalpel/code_parsers/csharp_parsers/csharp_parsers_StyleCop.py:25 __init__

- Group size 4 hash 07e1dea3d7... (Go parser __init__ duplicates)
  code_scalpel/code_parsers/go_parsers/go_parsers_gofmt.py:25 __init__
  code_scalpel/code_parsers/go_parsers/go_parsers_golint.py:26 __init__
  code_scalpel/code_parsers/go_parsers/go_parsers_govet.py:26 __init__
  code_scalpel/code_parsers/go_parsers/go_parsers_staticcheck.py:30 __init__

- Group size 3 hash 0212fc1950... (call_graph helpers)
  code_scalpel/ast_tools/call_graph.py:401 _children
  code_scalpel/ast_tools/call_graph.py:688 _children
  code_scalpel/ast_tools/call_graph.py:1232 _children

- Group size 3 hash 720dbfab41... (validator __init__ variants)
  code_scalpel/ast_tools/validator.py:221 __init__
  code_scalpel/ast_tools/validator.py:318 __init__
  code_scalpel/ast_tools/validator.py:351 __init__

- Group size 3 hash b166bc4f2f... (get_parser across languages)
  code_scalpel/code_parsers/cpp_parsers/__init__.py:53 get_parser
  code_scalpel/code_parsers/csharp_parsers/__init__.py:56 get_parser
  code_scalpel/code_parsers/go_parsers/__init__.py:56 get_parser

- Group size 3 hash 37dd2e1813... (analyze across languages)
  code_scalpel/code_parsers/cpp_parsers/__init__.py:57 analyze
  code_scalpel/code_parsers/csharp_parsers/__init__.py:60 analyze
  code_scalpel/code_parsers/go_parsers/__init__.py:60 analyze

- Group size 3 hash 2f419c3a9e... (violation_count helpers)
  code_scalpel/code_parsers/python_parsers/python_parsers_flake8.py:776 violation_count
  code_scalpel/code_parsers/python_parsers/python_parsers_pycodestyle.py:297 violation_count
  code_scalpel/code_parsers/python_parsers/python_parsers_pydocstyle.py:941 violation_count

- Group size 3 hash c9c52788bc... (SourceLocation structs)
  code_scalpel/code_parsers/python_parsers/python_parsers_interrogate.py:240 SourceLocation
  code_scalpel/code_parsers/python_parsers/python_parsers_radon.py:252 SourceLocation
  code_scalpel/code_parsers/python_parsers/python_parsers_vulture.py:210 SourceLocation

- Group size 3 hash 33bfc9c9b5... (__str__ helpers)
  code_scalpel/integrations/protocol_analyzers/graphql/schema_tracker.py:380 __str__
  code_scalpel/integrations/protocol_analyzers/schema/drift_detector.py:195 __str__
  code_scalpel/security/dependencies/schema_tracker.py:380 __str__

- Group size 3 hash 1b022d960e... (_utcnow_naive helpers)
  code_scalpel/licensing/jwt_validator.py:71 _utcnow_naive
  code_scalpel/licensing/license_manager.py:52 _utcnow_naive
  code_scalpel/licensing/validator.py:56 _utcnow_naive

Interpretation:
- Many duplicates are intentional polyglot adapters or shared tiny helpers (per-language parser init/analyze, SourceLocation, utcnow helpers).
- Small refactor candidates: call_graph._children variants; violation_count helpers could be centralized.
