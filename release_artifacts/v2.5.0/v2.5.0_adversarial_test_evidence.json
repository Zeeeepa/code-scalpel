{
  "version": "2.5.0",
  "release_name": "Guardian",
  "timestamp": "2025-12-16T21:54:44.785968",
  "test_suite": "v2.5.0_adversarial_tests",
  "summary": {
    "total_tests": 56,
    "passed": 56,
    "failed": 0,
    "pass_rate": "100%"
  },
  "test_categories": {
    "adversarial_tests": {
      "count": 18,
      "passed": 18,
      "tests": [
        "TestADV251TelephoneGame::test_telephone_game_confidence_decay",
        "TestADV251TelephoneGame::test_telephone_game_cumulative_decay",
        "TestADV252ThresholdRejection::test_threshold_rejection_flags_low_confidence",
        "TestADV252ThresholdRejection::test_threshold_rejection_warning_generated",
        "TestADV252ThresholdRejection::test_mcp_tool_reports_low_confidence",
        "TestADV253ContextExplosion::test_context_explosion_truncation",
        "TestADV253ContextExplosion::test_context_explosion_exactly_max_nodes",
        "TestADV253ContextExplosion::test_context_explosion_different_max_nodes",
        "TestADV254Relevance::test_relevance_high_confidence_retained",
        "TestADV254Relevance::test_relevance_confidence_filtering",
        "TestADV255ChmodBypass::test_chmod_bypass_detected",
        "TestADV255ChmodBypass::test_chmod_bypass_hash_mismatch_details",
        "TestADV256ManifestTamper::test_manifest_tamper_fake_signature",
        "TestADV256ManifestTamper::test_manifest_tamper_modified_hashes",
        "TestADV256ManifestTamper::test_manifest_tamper_wrong_secret",
        "TestADV256ManifestTamper::test_manifest_tamper_replay_old_manifest",
        "TestEvidenceGeneration::test_all_adversarial_tests_documented",
        "TestEvidenceGeneration::test_evidence_format"
      ]
    },
    "crypto_verification_tests": {
      "count": 18,
      "passed": 18,
      "tests": [
        "TestPolicyManifest::test_manifest_creation",
        "TestCryptographicPolicyVerifier::test_create_manifest",
        "TestCryptographicPolicyVerifier::test_create_manifest_multiple_files",
        "TestCryptographicPolicyVerifier::test_save_manifest",
        "TestCryptographicPolicyVerifier::test_verify_manifest_signature_valid",
        "TestCryptographicPolicyVerifier::test_verify_manifest_signature_invalid",
        "TestCryptographicPolicyVerifier::test_detect_tampered_policy_file",
        "TestCryptographicPolicyVerifier::test_detect_missing_policy_file",
        "TestCryptographicPolicyVerifier::test_verify_single_file",
        "TestCryptographicPolicyVerifier::test_verify_single_file_not_in_manifest",
        "TestCryptographicPolicyVerifier::test_missing_secret_key_fails_closed",
        "TestCryptographicPolicyVerifier::test_missing_manifest_fails_closed",
        "TestCryptographicPolicyVerifier::test_load_from_env",
        "TestCryptographicPolicyVerifier::test_wrong_secret_key_fails",
        "TestHashConsistency::test_hash_is_deterministic",
        "TestHashConsistency::test_hash_changes_with_content",
        "TestVerifyPolicyIntegrityCrypto::test_verify_policy_integrity_crypto_success",
        "TestTimingAttackPrevention::test_uses_constant_time_comparison"
      ]
    },
    "confidence_decay_tests": {
      "count": 9,
      "passed": 9,
      "tests": [
        "TestConfidenceDecay::test_calculate_confidence_formula",
        "TestConfidenceDecay::test_calculate_confidence_custom_decay_factor",
        "TestConfidenceDecay::test_extracted_symbol_has_depth_and_confidence",
        "TestConfidenceDecay::test_confidence_decays_with_depth",
        "TestConfidenceDecay::test_low_confidence_count_tracked",
        "TestConfidenceDecay::test_low_confidence_warning_generated",
        "TestConfidenceDecay::test_mcp_tool_returns_confidence",
        "TestConfidenceDecay::test_mcp_tool_custom_decay_factor",
        "TestConfidenceDecay::test_mcp_tool_low_confidence_warning"
      ]
    },
    "graph_neighborhood_tests": {
      "count": 11,
      "passed": 11,
      "tests": [
        "TestGraphNeighborhood::test_basic_neighborhood_extraction",
        "TestGraphNeighborhood::test_deeper_neighborhood",
        "TestGraphNeighborhood::test_neighborhood_truncation",
        "TestGraphNeighborhood::test_neighborhood_direction_outgoing",
        "TestGraphNeighborhood::test_neighborhood_direction_incoming",
        "TestGraphNeighborhood::test_neighborhood_nonexistent_node",
        "TestGraphNeighborhood::test_neighborhood_confidence_filtering",
        "TestGraphNeighborhood::test_mcp_tool_graph_neighborhood",
        "TestGraphNeighborhood::test_mcp_tool_generates_mermaid",
        "TestGraphNeighborhood::test_mcp_tool_invalid_parameters",
        "TestGraphNeighborhood::test_mcp_tool_invalid_direction"
      ]
    }
  },
  "adversarial_test_details": [
    {
      "id": "ADV-2.5.1",
      "name": "Telephone Game Test",
      "feature": "Confidence Decay",
      "description": "Create 10-hop chain, verify confidence = 0.9^10 \u2248 0.349",
      "formula": "C_effective = C_base \u00d7 0.9^depth",
      "expected_value": 0.3486784401,
      "status": "PASS",
      "security_impact": "Prevents false confidence in deep transitive dependencies"
    },
    {
      "id": "ADV-2.5.2",
      "name": "Threshold Rejection Test",
      "feature": "Confidence Decay",
      "description": "Verify agent blocked from low-confidence dependencies",
      "threshold": 0.5,
      "depth_threshold": 7,
      "status": "PASS",
      "security_impact": "Agents cannot act on uncertain information"
    },
    {
      "id": "ADV-2.5.3",
      "name": "Context Explosion Test",
      "feature": "Graph Neighborhood",
      "description": "Dense hub node (500+ connections) returns exactly max_nodes",
      "max_nodes_default": 100,
      "hub_connections_tested": 500,
      "status": "PASS",
      "security_impact": "Prevents context window exhaustion attacks"
    },
    {
      "id": "ADV-2.5.4",
      "name": "Relevance Test",
      "feature": "Graph Neighborhood",
      "description": "Pruned nodes are lowest confidence, not random",
      "pruning_strategy": "confidence-based",
      "status": "PASS",
      "security_impact": "Ensures high-value paths retained during truncation"
    },
    {
      "id": "ADV-2.5.5",
      "name": "chmod Bypass Test",
      "feature": "Cryptographic Policy Verification",
      "description": "chmod +w + file modification \u2192 hash mismatch detected",
      "attack_vector": "chmod +w .code-scalpel/policy.yaml && echo allow_all",
      "defense": "SHA-256 hash verification against signed manifest",
      "status": "PASS",
      "security_impact": "File permission bypass cannot circumvent policy"
    },
    {
      "id": "ADV-2.5.6",
      "name": "Manifest Tamper Test",
      "feature": "Cryptographic Policy Verification",
      "description": "Fake signature \u2192 HMAC verification fails \u2192 DENY ALL",
      "attack_vectors": [
        "Modified signature",
        "Modified file hashes",
        "Wrong secret key",
        "Replay attack with old manifest"
      ],
      "defense": "HMAC-SHA256 signature verification",
      "fail_mode": "FAIL CLOSED",
      "status": "PASS",
      "security_impact": "Manifest tampering cannot bypass verification"
    }
  ],
  "features_implemented": [
    {
      "name": "Confidence Decay",
      "formula": "C_effective = C_base \u00d7 decay_factor^depth",
      "default_decay_factor": 0.9,
      "default_threshold": 0.5,
      "mcp_tool": "get_cross_file_dependencies (confidence_decay_factor parameter)"
    },
    {
      "name": "Graph Neighborhood View",
      "formula": "N(v, k) = {u \u2208 V : d(v, u) \u2264 k}",
      "default_max_nodes": 100,
      "mcp_tool": "get_graph_neighborhood",
      "features": [
        "k-hop extraction",
        "truncation protection",
        "Mermaid visualization"
      ]
    },
    {
      "name": "Cryptographic Policy Verification",
      "algorithms": [
        "SHA-256 (file hashes)",
        "HMAC-SHA256 (manifest signature)"
      ],
      "manifest_sources": [
        "git",
        "env",
        "file"
      ],
      "mcp_tool": "verify_policy_integrity",
      "security_model": "FAIL CLOSED"
    }
  ],
  "acceptance_criteria_status": {
    "confidence_decay": {
      "exponential_decay_applied": true,
      "chain_confidence_calculated": true,
      "recommendations_generated": true,
      "configurable_decay_factor": true,
      "graph_neighborhood_integration": true
    },
    "graph_neighborhood": {
      "k_hop_bfs_extraction": true,
      "respects_max_nodes_limit": true,
      "applies_confidence_decay": true,
      "filters_by_min_confidence": true,
      "mcp_tool_exposed": true,
      "confidence_summary_included": true
    },
    "crypto_verification": {
      "sha256_hashes_correct": true,
      "hmac_signature_works": true,
      "manifest_from_git": true,
      "tampering_detected": true,
      "cli_command_signing": false,
      "fails_closed": true,
      "environment_variable_secret": true
    }
  }
}